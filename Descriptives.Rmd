---
title: "Descriptives"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**ULTIMA ACTUALIZACIÓN:**

```{r}
print(Sys.time())
```


# Tabla de Contenidos

Parte I: 

- [Descriptivos básicos](#T1)
    a) [Tablas de Frequencias](#T1.1)
    b) [Gráficos descriptivos](#T1.2)
- [Correlaciones](#T2)
- [Differencias de medias](#T3)
- [Chi-square otras](#T3)
  

## Descriptivos básicos  <a name="T1"></a>

Reutilizamos la base de datos con la que hemos venido trabajando **s2018** en la sección anterior

```{r, echo=FALSE}
library(rio)
library(dplyr)
set.seed(100)
s2018<-import("./data_examples/sumaria-2018.dta")%>%
  sample_n(1000)
```

```{r}
names(s2018)[141]<-"ingreso_bruto"
```

Existen funciones que nos pueden dar un vistazo a toda la base de datos. La más útil es: summary. Podemos pedir un summary de la base de datos o de una variable

```{r, eval=FALSE}
summary(s2018) # De toda la base de datos
```

```{r}
summary(s2018$ingreso_bruto)
```

Dentro del paquete Hmisc tenemos varias funciones útiles. 

```{r eval=FALSE}
install.packages("Hmisc") #Si no lo tienes instalado ya. 
```

```{r}
library(Hmisc)
```

```{r}
describe(s2018$ingreso_bruto)
```

Podemos pedir medidas especifícas, es bueno agregar ```na.rm=true``` ya que si tenemos valores perdidos generaría error en el cálculo. 

```{r}
mean(s2018$ingreso_bruto, na.rm = TRUE) ## Media
median(s2018$ingreso_bruto) ## Mediana
sd(s2018$ingreso_bruto) ## Desviación estandard
var(s2018$ingreso_bruto)
```

Podemos pedir medidas de posición:

```{r}
quantile(s2018$ingreso_bruto, 0.9) #percentil 90
```

Podemos pedir varios a la vez, combinando funciones. Por ejemplo la función ```seq(inicio, final, salto)``` 

```{r}
quantile(s2018$ingreso_bruto, seq(0.1,0.9,0.1))
```

### Tablas: <a name="T1.1"></a> 

Frequencias.

```{r}
table(s2018$estrsocial)
```

Proportion table. 

```{r}
prop.table(table(s2018$estrsocial))
```

Tablas con Dplyr:


```{r}
s2018%>%group_by(estrsocial)%>%
  summarise(Frequency=n())%>%
  mutate(Porcentaje=Frequency/sum(Frequency)*100)%>%
  mutate(Estratos=names(attributes(s2018$estrsocial)$labels))%>%
  select(Estratos,Frequency,Porcentaje)
```




### Gráficos Descriptivos: <a name="T1.1"></a>

Existen funciones básicas para gráficos en R, pero la versatilidad de R para gráficos va más allá de estas funciones básicas. Paquetes como **ggplot** han llevado a otro nivel el análisis gráfico de R. 

Aquí trataremos de mostra ambos. 

### Graficos de Barra simples en R 

```{r}
barplot(table(s2018$estrsocial))
```

Podemos cambiar algunas cosas:

```{r}
barplot(table(s2018$estrsocial), col="red",
        names.arg = names(attributes(s2018$estrsocial)$labels), 
        main="Este es un título")
```

### Graficos de Barra simples en **ggplot** y **dplyr**

- ggplot: es el paso inicial para crear un "ambiente" ggplot.
- **+** vas agregando capas (detalles) al objecto
- ```geom_bar``` es que crearemos un gráficos de barras

```{r}
library(ggplot2) # Recuerda que tienes haberlo instalado antes. 
s2018%>%ggplot(aes(x=estrsocial))+
    geom_bar(stat="bin", bins=20)
```

Al mismo gráfico le cambiamos el nombre de los ejes con ```labs```, incluso le podemos agregar una "nota" 

```{r}
s2018%>%ggplot(aes(x=estrsocial))+
    geom_bar(stat="bin", bins=20)+
    labs(y="Frecuencia", x="Estrato Social",
         caption="(Tomado de....)")
```

Ahora le cambiamos la etiqueta al eje x!.

```{r}
s2018%>%ggplot(aes(x=estrsocial))+
    geom_bar(stat="bin", bins=20)+
    labs(y="Frecuencia", x="Estrato Social",
         caption="(Tomado de....)")+
    scale_x_discrete(limit= c("A","B","C","D",
                               "E","Rural"))
```

Gráficos con porcentajes

- En este caso manipulamos la data con dplyr para obtener los porcentajes por cada grupo. 
```{r}
s2018%>%group_by(estrsocial)%>%
  summarise(Frequencia=n())%>% ## Tabla de frecuencias 
  mutate(Porcentaje=Frequencia/sum(Frequencia)*100)%>% ##Agregando porcentajes
  ggplot(aes(x=estrsocial, y=Porcentaje))+
  geom_bar(stat="identity", fill="red")+
  scale_x_discrete(limit= c("A","B","C","D",
                               "E","Rural"))
  
```

### Box plot o diagramas de cajas

```{r}
boxplot(s2018$estrsocial, col="red")
```

```{r, eval=FALSE}
boxplot(s2018$ingreso_bruto~s2018$estrsocial, col="red")
## Boxplot by groups 
```

### Box plot o diagramas de cajas con **dyplr** y **ggplot2**

```{r}
s2018%>%ggplot(aes(y=estrsocial))+
  geom_boxplot(col="red", fill="blue")
```



