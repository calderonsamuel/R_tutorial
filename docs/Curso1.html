<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Basicos_R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="Curso1.html">
    <span class="fa fa-newspaper-o"></span>
     
    Basicos
  </a>
</li>
<li>
  <a href="Curso1.html">
    <span class="fa fa-newspaper-o"></span>
     
    Descriptives
  </a>
</li>
<li>
  <a href="Curso1.html">
    <span class="fa fa-newspaper-o"></span>
     
    Gráficos
  </a>
</li>
<li>
  <a href="Curso1.html">
    <span class="fa fa-newspaper-o"></span>
     
    Modelos
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Basicos_R</h1>

</div>

<div id="TOC">
true
</div>

<style>
#TOC {
  top: 1%;
  opacity: 0.5;
}
#TOC:hover {
  opacity: 1;
}
</style>
<p><strong>ULTIMA ACTUALIZACIÓN:</strong></p>
<pre class="r"><code>print(Sys.time())</code></pre>
<pre><code>## [1] &quot;2019-07-25 14:35:30 EDT&quot;</code></pre>
<div id="tabla-de-contenidos" class="section level1">
<h1>Tabla de Contenidos</h1>
<p>Parte I:</p>
<ul>
<li><a href="#T1">Descargando e instalando R</a></li>
<li><a href="#T2">La consola de R y comandos basicos</a></li>
<li><a href="#T3">Subiendo una base de datos</a></li>
</ul>
<p>Parte II: Manipular y limpiar base de datos</p>
<ul>
<li>Recode</li>
<li>Rename y re label</li>
<li>gen variable (categorica, dicotomica, average de grupo)</li>
<li>Missing – finding them (no sean en 0s si se grabo asi – a missing )</li>
</ul>
<p>Parte III: Estadisticos descriptivos</p>
<ul>
<li>Media, mediana, moda, SD</li>
<li>Graficos simples de distribucion</li>
<li>Percentiles</li>
<li>Dos variables – diferencia de medias, correlaciones, GRaficosde distribucion y correlacion</li>
</ul>
<p>Parte IV: Analisis y Graficos</p>
<ul>
<li>Regresion simple y diagnostico</li>
<li>Graficos de ajustes de regresion</li>
<li>Controlando por otras variables</li>
<li>Cluster SE</li>
<li>Efectos fijos</li>
<li>Probit/logit – odss ratio y marginal efects</li>
</ul>
</div>
<div id="basicos." class="section level1">
<h1>Basicos.</h1>
<p>Cuando inicias <strong>R</strong> se activan un grupo básicos de paquetes. Los paquetes tienen funciones y las funciones argumentos.</p>
<p>Puedes instalar paquetes usando <code>install.packages("nombre del paquete")</code>. Los paquetes se instalan una sola vez. Luego de eso ya estan en la memoria de tu computadora.</p>
<p>Cada vez que necesitas un paquete lo puedes llamar con: <code>library(paquete)</code>.</p>
<p>Por ejemplo si corres un código y el resultado es un error con un mensaje que dice: <strong>could not find function “xxx”</strong>. Entonces no has llamado el paquete (usando library) y si llamas al paqute y te resulta un error con el siguiente mensaje: <strong>Error in library(paquete) : there is no package called ‘paquete’</strong> significa que necesitas instalarlo.</p>
<div id="subiendo-una-base-de-datos" class="section level2">
<h2>Subiendo una base de datos <a name="T3"></a></h2>
<p>Para subir una base de datos (BD), debes antes haber instalado una serie de paquetes que permiten leer la base de datos sin importar en que formato este. Existen varios paquetes que nos pueden ayudar con eso. En este tutorial trabajaremos con <code>rio</code>. Rio nos permite abrir distintos tipos de base de datos con facilidad.</p>
<pre class="r"><code>install.packages(&quot;rio&quot;)</code></pre>
<pre class="r"><code>library(rio)</code></pre>
<p>Segundo, llamamos a nuestra base de datos.</p>
<p><strong>IMPORTANTE</strong> antes de interacturar con folders (subir data, grabar resultados, gráficos, etc) tienes que establecer tu directorio de trabajo. La forma más rápida es con la rueda con la etiqueta “more” en el panel derecho.</p>
<p><img src="data_examples/Rstudio_swd.png" width="80%" /></p>
<p>La base de datos debe estar en nuestro espacio de trabajo. La Base de Datos que usaremos es una muestra de la ENAHO - PERU (Encuesta Nacional de Hogares del Peru) del 2017. La base <strong>sumaria-2018.dta</strong>. Aquí esta el link de donde pueden descargarla <embed src="http://iinei.inei.gob.pe/iinei/srienaho/descarga/STATA/634-Modulo34.zip" />. Tenemos informacion sobre ingresos, y gastos de los hogares en Perú.</p>
<p>En esta página estoy trabajando con una selección aleatoria de 1000 casos. La base original tiene más de 30 mil casos.</p>
<p>Dado que tenemos el paquete rio, no necesitamos decirle a R que nuestra base de datos esta en STATA, R lo entiende.</p>
<p>Vamos a usar el comando import y asignarle un nombre a nuestra base de datos. Lo llamaremos <strong>S2018</strong>. Abajo podemos ver las primeras 4 variables y primeras 10 observaciones.</p>
<pre class="r"><code>s2018&lt;-import(&quot;./data_examples/summaria-2018.dta&quot;)</code></pre>
<pre class="r"><code>head(s2018) #Give us the first six cases. </code></pre>
<p>Siempre es bueno mirar la base de datos con la cual estamos trabajando para darnos una idea mas concreta de que estamos haciendo. Primero debemos saber con que tipo de objeto estamos lidiando.</p>
<pre class="r"><code>str(s2018) ## Te da el tipo de objeto y el tipo de cada variable. </code></pre>
<pre class="r"><code>is.data.frame(s2018) ## Es otra forma de comprobarlo.</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>En este caso <strong>Ej_Enaho</strong> es un objeto de tipo data frame, por lo que tiene dos dimensiones, saber esto es importante por que así podemos manipularlas.</p>
<p>En el código debajo estamos seleccionando los 20 primeros casos (1:20), y las tres primeras variables (1:3). Conocer las dimensiones es útil para luego filtrar la base de datos.</p>
<pre class="r"><code>s2018[1:20,1:3]</code></pre>
<pre><code>##     aÑo mes nconglome
## 1  2018  06    021521
## 2  2018  02    033493
## 3  2018  10    039710
## 4  2018  08    000909
## 5  2018  04    015685
## 6  2018  09    018285
## 7  2018  08    011964
## 8  2018  04    030180
## 9  2018  06    009642
## 10 2018  03    032546
## 11 2018  11    035275
## 12 2018  07    004174
## 13 2018  05    014759
## 14 2018  06    044238
## 15 2018  06    032325
## 16 2018  05    013461
## 17 2018  05    007615
## 18 2018  08    011434
## 19 2018  10    042844
## 20 2018  07    014755</code></pre>
<p>Si eres ansioso y quieres ver toda la base de datos puedes usar el siguiente código:</p>
<pre class="r"><code>View(s2018)</code></pre>
<p>Podriamos mirar una muestra de nuestra base de datos con la opcion head. Abajo, le pedimos que nos puestre las 300 primeras observaciones.</p>
<pre class="r"><code>View(head(s2018,300))</code></pre>
<p>La función <strong>import</strong> de rio permite subir archivos en distintos formatos. Existen otros paquetes como <strong>foreign</strong> que también hacen lo mismo. Pero <strong>rio</strong> me parece más conveniente.</p>
</div>
<div id="parte-ii-manipular-y-limpiar-base-de-datos" class="section level2">
<h2>Parte II: Manipular y limpiar base de datos</h2>
<p>En esta secciones aprenderemos algunas de los pasos mas frecuentes que hacemos al encontrarnos con una nueva base de datos: limpiar y manipular algunas variables para que pueda analizarse. Debemos limpiar nuestra base de datos por muchas razones; quizas para calcular las variables que queremos, para desacernos de grupos de observaciones que no nos interesan o para hacer mas fácil el juntar nuestra base de datos con otras.</p>
<div id="re-nombrar-y-etiquetar-variables" class="section level3">
<h3>Re-nombrar y etiquetar variables</h3>
<p>Podemos llamar nuestras variables en la BD con la función <code>names</code> o también <code>ls</code></p>
<pre class="r"><code>ls(s2018) ## Este comando te las da en nombre alfabetico</code></pre>
<pre><code>##   [1] &quot;aÑo&quot;        &quot;conglome&quot;   &quot;dominio&quot;    &quot;estrato&quot;    &quot;estrsocial&quot;
##   [6] &quot;factor07&quot;   &quot;g05hd&quot;      &quot;g05hd1&quot;     &quot;g05hd2&quot;     &quot;g05hd3&quot;    
##  [11] &quot;g05hd4&quot;     &quot;g05hd5&quot;     &quot;g05hd6&quot;     &quot;g07hd&quot;      &quot;ga03hd&quot;    
##  [16] &quot;ga04hd&quot;     &quot;gashog1d&quot;   &quot;gashog21&quot;   &quot;gashog22&quot;   &quot;gashog23&quot;  
##  [21] &quot;gashog24&quot;   &quot;gashog25&quot;   &quot;gashog26&quot;   &quot;gashog2d&quot;   &quot;gru11hd&quot;   
##  [26] &quot;gru12hd1&quot;   &quot;gru12hd2&quot;   &quot;gru13hd1&quot;   &quot;gru13hd2&quot;   &quot;gru13hd3&quot;  
##  [31] &quot;gru13hd4&quot;   &quot;gru14hd&quot;    &quot;gru14hd1&quot;   &quot;gru14hd2&quot;   &quot;gru14hd3&quot;  
##  [36] &quot;gru14hd4&quot;   &quot;gru14hd5&quot;   &quot;gru14hd6&quot;   &quot;gru21hd&quot;    &quot;gru22hd1&quot;  
##  [41] &quot;gru22hd2&quot;   &quot;gru23hd1&quot;   &quot;gru23hd2&quot;   &quot;gru23hd3&quot;   &quot;gru24hd&quot;   
##  [46] &quot;gru31hd&quot;    &quot;gru32hd1&quot;   &quot;gru32hd2&quot;   &quot;gru33hd1&quot;   &quot;gru33hd2&quot;  
##  [51] &quot;gru33hd3&quot;   &quot;gru34hd&quot;    &quot;gru41hd&quot;    &quot;gru42hd1&quot;   &quot;gru42hd2&quot;  
##  [56] &quot;gru43hd1&quot;   &quot;gru43hd2&quot;   &quot;gru43hd3&quot;   &quot;gru44hd&quot;    &quot;gru51hd&quot;   
##  [61] &quot;gru52hd1&quot;   &quot;gru53hd1&quot;   &quot;gru53hd2&quot;   &quot;gru53hd3&quot;   &quot;gru53hd4&quot;  
##  [66] &quot;gru54hd&quot;    &quot;gru61hd&quot;    &quot;gru62hd1&quot;   &quot;gru62hd2&quot;   &quot;gru63hd1&quot;  
##  [71] &quot;gru63hd2&quot;   &quot;gru63hd3&quot;   &quot;gru64hd&quot;    &quot;gru71hd&quot;    &quot;gru72hd1&quot;  
##  [76] &quot;gru72hd2&quot;   &quot;gru73hd1&quot;   &quot;gru73hd2&quot;   &quot;gru73hd3&quot;   &quot;gru74hd&quot;   
##  [81] &quot;gru81hd&quot;    &quot;gru82hd1&quot;   &quot;gru82hd2&quot;   &quot;gru83hd1&quot;   &quot;gru83hd2&quot;  
##  [86] &quot;gru83hd3&quot;   &quot;gru83hd4&quot;   &quot;gru84hd&quot;    &quot;gru84hd1&quot;   &quot;gru85hd1&quot;  
##  [91] &quot;gru86hd1&quot;   &quot;gru86hd2&quot;   &quot;gru87hd&quot;    &quot;hogar&quot;      &quot;ia01hd&quot;    
##  [96] &quot;ia02hd&quot;     &quot;ig03hd1&quot;    &quot;ig03hd2&quot;    &quot;ig03hd3&quot;    &quot;ig03hd4&quot;   
## [101] &quot;ig06hd&quot;     &quot;ig06hd1&quot;    &quot;ig06hd2&quot;    &quot;ig06hd3&quot;    &quot;ig06hd4&quot;   
## [106] &quot;ig06hd5&quot;    &quot;ig06hd6&quot;    &quot;ig08hd&quot;     &quot;ingauthd&quot;   &quot;ingbruhd&quot;  
## [111] &quot;ingexthd&quot;   &quot;inghog1d&quot;   &quot;inghog2d&quot;   &quot;ingindhd&quot;   &quot;ingmo1hd&quot;  
## [116] &quot;ingmo2hd&quot;   &quot;ingnethd&quot;   &quot;ingoexhd&quot;   &quot;ingotrhd&quot;   &quot;ingrenhd&quot;  
## [121] &quot;ingseihd&quot;   &quot;ingtexhd&quot;   &quot;ingtprhd&quot;   &quot;ingtpu01&quot;   &quot;ingtpu02&quot;  
## [126] &quot;ingtpu03&quot;   &quot;ingtpu04&quot;   &quot;ingtpu05&quot;   &quot;ingtpuhd&quot;   &quot;ingtrahd&quot;  
## [131] &quot;insedlhd&quot;   &quot;insedthd&quot;   &quot;isecauhd&quot;   &quot;ld&quot;         &quot;linea&quot;     
## [136] &quot;linpe&quot;      &quot;mes&quot;        &quot;mieperho&quot;   &quot;nconglome&quot;  &quot;paesechd&quot;  
## [141] &quot;pagesphd&quot;   &quot;percepho&quot;   &quot;pobreza&quot;    &quot;sg23&quot;       &quot;sg25&quot;      
## [146] &quot;sg42&quot;       &quot;sg421&quot;      &quot;sg422&quot;      &quot;sg423&quot;      &quot;sg42d&quot;     
## [151] &quot;sg42d1&quot;     &quot;sg42d2&quot;     &quot;sg42d3&quot;     &quot;sig24&quot;      &quot;sig26&quot;     
## [156] &quot;totmieho&quot;   &quot;ubigeo&quot;     &quot;vivienda&quot;</code></pre>
<pre class="r"><code>names(s2018)## Te los da en el orden en que estan en la base de datos. </code></pre>
<pre><code>##   [1] &quot;aÑo&quot;        &quot;mes&quot;        &quot;nconglome&quot;  &quot;conglome&quot;   &quot;vivienda&quot;  
##   [6] &quot;hogar&quot;      &quot;ubigeo&quot;     &quot;dominio&quot;    &quot;estrato&quot;    &quot;percepho&quot;  
##  [11] &quot;mieperho&quot;   &quot;totmieho&quot;   &quot;ia01hd&quot;     &quot;ia02hd&quot;     &quot;ig03hd1&quot;   
##  [16] &quot;ig03hd2&quot;    &quot;ig03hd3&quot;    &quot;ig03hd4&quot;    &quot;ga03hd&quot;     &quot;ga04hd&quot;    
##  [21] &quot;sg23&quot;       &quot;sig24&quot;      &quot;sg25&quot;       &quot;sig26&quot;      &quot;sg42&quot;      
##  [26] &quot;sg421&quot;      &quot;sg422&quot;      &quot;sg423&quot;      &quot;sg42d&quot;      &quot;sg42d1&quot;    
##  [31] &quot;sg42d2&quot;     &quot;sg42d3&quot;     &quot;ingbruhd&quot;   &quot;ingnethd&quot;   &quot;pagesphd&quot;  
##  [36] &quot;ingindhd&quot;   &quot;ingauthd&quot;   &quot;insedthd&quot;   &quot;insedlhd&quot;   &quot;paesechd&quot;  
##  [41] &quot;ingseihd&quot;   &quot;isecauhd&quot;   &quot;ingexthd&quot;   &quot;ingtrahd&quot;   &quot;ingtexhd&quot;  
##  [46] &quot;ingrenhd&quot;   &quot;ingoexhd&quot;   &quot;g05hd&quot;      &quot;ig06hd&quot;     &quot;g05hd1&quot;    
##  [51] &quot;ig06hd1&quot;    &quot;g05hd2&quot;     &quot;ig06hd2&quot;    &quot;g05hd3&quot;     &quot;ig06hd3&quot;   
##  [56] &quot;g05hd4&quot;     &quot;ig06hd4&quot;    &quot;g05hd5&quot;     &quot;ig06hd5&quot;    &quot;g05hd6&quot;    
##  [61] &quot;ig06hd6&quot;    &quot;g07hd&quot;      &quot;ig08hd&quot;     &quot;ingtprhd&quot;   &quot;ingtpuhd&quot;  
##  [66] &quot;ingtpu01&quot;   &quot;ingtpu02&quot;   &quot;ingtpu03&quot;   &quot;ingtpu04&quot;   &quot;ingtpu05&quot;  
##  [71] &quot;gru11hd&quot;    &quot;gru12hd1&quot;   &quot;gru12hd2&quot;   &quot;gru13hd1&quot;   &quot;gru13hd2&quot;  
##  [76] &quot;gru13hd3&quot;   &quot;gru13hd4&quot;   &quot;gru14hd&quot;    &quot;gru14hd1&quot;   &quot;gru14hd2&quot;  
##  [81] &quot;gru14hd3&quot;   &quot;gru14hd4&quot;   &quot;gru14hd5&quot;   &quot;gru14hd6&quot;   &quot;gru21hd&quot;   
##  [86] &quot;gru22hd1&quot;   &quot;gru22hd2&quot;   &quot;gru23hd1&quot;   &quot;gru23hd2&quot;   &quot;gru23hd3&quot;  
##  [91] &quot;gru24hd&quot;    &quot;gru31hd&quot;    &quot;gru32hd1&quot;   &quot;gru32hd2&quot;   &quot;gru33hd1&quot;  
##  [96] &quot;gru33hd2&quot;   &quot;gru33hd3&quot;   &quot;gru34hd&quot;    &quot;gru41hd&quot;    &quot;gru42hd1&quot;  
## [101] &quot;gru42hd2&quot;   &quot;gru43hd1&quot;   &quot;gru43hd2&quot;   &quot;gru43hd3&quot;   &quot;gru44hd&quot;   
## [106] &quot;gru51hd&quot;    &quot;gru52hd1&quot;   &quot;gru53hd1&quot;   &quot;gru53hd2&quot;   &quot;gru53hd3&quot;  
## [111] &quot;gru53hd4&quot;   &quot;gru54hd&quot;    &quot;gru61hd&quot;    &quot;gru62hd1&quot;   &quot;gru62hd2&quot;  
## [116] &quot;gru63hd1&quot;   &quot;gru63hd2&quot;   &quot;gru63hd3&quot;   &quot;gru64hd&quot;    &quot;gru71hd&quot;   
## [121] &quot;gru72hd1&quot;   &quot;gru72hd2&quot;   &quot;gru73hd1&quot;   &quot;gru73hd2&quot;   &quot;gru73hd3&quot;  
## [126] &quot;gru74hd&quot;    &quot;gru81hd&quot;    &quot;gru82hd1&quot;   &quot;gru82hd2&quot;   &quot;gru83hd1&quot;  
## [131] &quot;gru83hd2&quot;   &quot;gru83hd3&quot;   &quot;gru83hd4&quot;   &quot;gru84hd&quot;    &quot;gru84hd1&quot;  
## [136] &quot;gru85hd1&quot;   &quot;gru86hd1&quot;   &quot;gru86hd2&quot;   &quot;gru87hd&quot;    &quot;ingotrhd&quot;  
## [141] &quot;ingmo1hd&quot;   &quot;ingmo2hd&quot;   &quot;inghog1d&quot;   &quot;inghog2d&quot;   &quot;gashog1d&quot;  
## [146] &quot;gashog21&quot;   &quot;gashog22&quot;   &quot;gashog23&quot;   &quot;gashog24&quot;   &quot;gashog26&quot;  
## [151] &quot;gashog25&quot;   &quot;gashog2d&quot;   &quot;ld&quot;         &quot;estrsocial&quot; &quot;linpe&quot;     
## [156] &quot;linea&quot;      &quot;pobreza&quot;    &quot;factor07&quot;</code></pre>
<p>Por ejemplo la variable <strong>inghog1d</strong> (posición 141) es el ingreso bruto anual queremos cambiar el nombre a “ingreso_bruto”.</p>
<p>La forma más rápida es:</p>
<pre class="r"><code>names(s2018)[141]&lt;-&quot;ingreso_bruto&quot;</code></pre>
<p>Si no tenemos la ubicación, quizás son miles de variables, podemos también usar</p>
<pre class="r"><code>names(s2018)[names(s2018) == &quot;inghog1d&quot;] &lt;-&quot;ingreso_bruto&quot;
## Si ya corriste el código anterior este te va a dar error, ya que está buscando un nombre que no existe ;)</code></pre>
<p>Pedimos el nombre de variables denuevo</p>
<pre class="r"><code>names(s2018)[140:145] #Exacto! podemos indexar para no ver todas las variables nuevamente </code></pre>
<pre><code>## [1] &quot;ingotrhd&quot;      &quot;ingreso_bruto&quot; &quot;ingmo2hd&quot;      &quot;inghog1d&quot;     
## [5] &quot;inghog2d&quot;      &quot;gashog1d&quot;</code></pre>
<p><strong>etiquetas</strong></p>
<p>Si subimos la base de datos desde STATA, estas pueden tener etiquetas.</p>
<p>Por ejemplo, veamos la etiqueta de nuestra variables “ingreso_bruto”</p>
<pre class="r"><code>label(s2018$ingreso_bruto)</code></pre>
<pre><code>## [1] &quot;ingreso monetario (bruto)&quot;</code></pre>
<p>Queremos cambiarla a “ingreso monetario (bruto) anual”</p>
<pre class="r"><code>label(s2018$ingreso_bruto)&lt;-&quot;ingreso monetario (bruto) anual&quot;
label(s2018$ingreso_bruto) #Veamos el cambio!.</code></pre>
<pre><code>## [1] &quot;ingreso monetario (bruto) anual&quot;</code></pre>
</div>
<div id="recodificar-variables" class="section level3">
<h3>Recodificar variables</h3>
<p>Ahora recodificaremos los valores de la variable con que estamos trabajando.</p>
<p>Usamos la funcion abajo para ver los valores y las etiquetas de la variable que creamos.</p>
<pre class="r"><code>attributes(s2018$estrsocial)$labels</code></pre>
<pre><code>##     a     b     c     d     e rural 
##     1     2     3     4     5     6</code></pre>
<p>Queremos recodificar los valores de <strong>rural</strong> de 6 a 0.</p>
<pre class="r"><code>s2018[s2018$estrsocial==6,]$estrsocial&lt;-0</code></pre>
<p>Si pedimos una tabla vemos que el cambio se realizo:</p>
<pre class="r"><code>table(s2018$estrsocial)</code></pre>
<pre><code>## 
##   0   1   2   3   4   5 
## 383  17  34  81 226 259</code></pre>
<p>Pero las etiquetas siguen mostrando el orden anterior</p>
<pre class="r"><code>attributes(s2018$estrsocial)$labels</code></pre>
<pre><code>##     a     b     c     d     e rural 
##     1     2     3     4     5     6</code></pre>
<pre class="r"><code>attributes(s2018$estrsocial)$labels[[1]]&lt;-0
attributes(s2018$estrsocial)$labels</code></pre>
<pre><code>##     a     b     c     d     e rural 
##     0     2     3     4     5     6</code></pre>
</div>
<div id="generar-variables-categorica-dicotomica-average-de-grupo" class="section level3">
<h3>Generar variables (categorica, dicotomica, average de grupo)</h3>
<p>Ahora vamos a generar distintos tipos de variables. Empecemos con una variable dicotomica. Vamos a usar informacion sobre el ingreso reportado</p>
</div>
<div id="variable-categoricas" class="section level3">
<h3>Variable categóricas</h3>
<p>Generemos una variable que toma el valor de 1 si es que el informante gana más de 800 soles y 0 si es menos o igual. Creamos una variable vacia y le incluimos los argumentos:</p>
<ul>
<li>Forma 1:</li>
</ul>
<pre class="r"><code>s2018$minimo&lt;-NA
s2018[s2018$ingreso_bruto&lt;=800,]$minimo&lt;-0
s2018[s2018$ingreso_bruto&gt;800,]$minimo&lt;-1
table(s2018$minimo)</code></pre>
<pre><code>## 
##   0   1 
##  16 984</code></pre>
<ul>
<li>Forma 2:</li>
</ul>
<pre class="r"><code>s2018$minimo&lt;-NA
s2018$minimo&lt;-ifelse(s2018$ingreso_bruto&lt;=800,0,1)
table(s2018$minimo)</code></pre>
<pre><code>## 
##   0   1 
##  16 984</code></pre>
<ul>
<li>Forma 3: <strong>USANDO DPLYR para crear nuevas variables</strong></li>
</ul>
<p>Dplyr es un paquete que es muy útil para manipular data, es relativamente nuevo y cada vez está siendo más usado.</p>
<p>Dplyr y Tydir son muy populares, así que es bueno ir familiarizandose con ellos.</p>
<p>Lo especial de Dplyr es que tiene sus propias funciones y además que conecta funciones usando <strong>%&gt;%</strong>. De esa manera puede ser más eficiente con el espacio de trabajo, evitando crear muchos objetos.</p>
<p>En este caso la función es <strong>mutate</strong></p>
<pre class="r"><code>s2018&lt;-s2018%&gt;%mutate(minimo=ifelse(s2018$ingreso_bruto&lt;=800,0,1))
table(s2018$minimo)</code></pre>
<pre><code>## 
##   0   1 
##  16 984</code></pre>
</div>
<div id="medidas-por-grupo." class="section level3">
<h3>Medidas por grupo.</h3>
<p>Por ejemplo queremos calcular el promedio de cada grupo. Usaremos <strong>dplyr</strong> para calcular el promedio de ingreso y la desviación estandar por cada ubigeo (municipalidad)</p>
<ul>
<li>Podemos concatenar funciones. Primero hemos “agrupado” la base de datos, luego hemos calculado el promedio, y la desviación estandard en base a la variable de agrupación.</li>
<li><code>arrange</code> es para ordernar los ubigeos</li>
<li>`<code>select</code> para quedarnos con algunas variables (son más de 150)</li>
<li>`<code>head</code> para pedir los 6 primeros casos.</li>
</ul>
<pre class="r"><code>s2018%&gt;%group_by(ubigeo)%&gt;%
  mutate(promedio=mean(ingreso_bruto),
         desv=sd(ingreso_bruto))%&gt;%
  arrange(ubigeo)%&gt;%
  select(c(1:3,160,161))%&gt;%head()</code></pre>
<pre><code>## Adding missing grouping variables: `ubigeo`</code></pre>
<pre><code>## # A tibble: 6 x 6
## # Groups:   ubigeo [3]
##   ubigeo aÑo   mes   nconglome promedio   desv
##   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
## 1 010101 2018  10    007100      80756. 43287.
## 2 010101 2018  06    007066      80756. 43287.
## 3 010112 2018  12    007151      22392     NA 
## 4 010201 2018  08    006599      10520.  4929.
## 5 010201 2018  04    006618      10520.  4929.
## 6 010201 2018  08    006641      10520.  4929.</code></pre>
<p>Ahora bien los cambios no se han guardado en la base de datos para hacerlo debemos remplazar el objeto o crear uno nuevo.</p>
<pre class="r"><code>s2018&lt;-s2018%&gt;%group_by(ubigeo)%&gt;%
  mutate(promedio=mean(ingreso_bruto),
         desv=sd(ingreso_bruto))%&gt;%
  arrange(ubigeo)### Aquí nuestra base ha cambiado ya que tiene dos variables más</code></pre>
</div>
</div>
<div id="merge-y-append-bases-de-datos" class="section level2">
<h2>Merge y append bases de datos</h2>
<ul>
<li>Creemos una base de datos que contenga el ingreso promedio por distrito. Similar a nuestro ejercicio anterior pero ahora la base será un objeto aparte.</li>
</ul>
<pre class="r"><code>resumen&lt;-s2018%&gt;%group_by(ubigeo)%&gt;%
  summarise(promedio=mean(ingreso_bruto),
            desv=sd(ingreso_bruto))
head(resumen)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   ubigeo promedio   desv
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
## 1 010101   80756. 43287.
## 2 010112   22392     NA 
## 3 010201   10520.  4929.
## 4 010202    3746.  2255.
## 5 010203   17275     NA 
## 6 010205   11892  14875.</code></pre>
<p>La diferencia aquí es que hemos usado <code>summarise</code> en lugar de <code>mutate</code>. Ya que no estamos agregando una variable a la base. Estamos creando una nueva base.</p>
<pre class="r"><code>nrow(resumen)</code></pre>
<pre><code>## [1] 514</code></pre>
<p>Ahora juntemos las bases de datos. El proceso es más conocido como “merge” o “join”</p>
<pre class="r"><code>s2018&lt;-s2018%&gt;%left_join(resumen, by=&quot;ubigeo&quot;)
head(s2018[,c(6,159,160)])</code></pre>
<pre><code>##   hogar minimo  promedio
## 1    11      1 20971.317
## 2    11      1  4007.568
## 3    11      1  8651.279
## 4    12      1 39084.833
## 5    11      1  4224.000
## 6    11      1 30128.250</code></pre>
<p>Existen diferentes tipos de “join”</p>
<ul>
<li>left_join()</li>
<li>rigth_join()</li>
<li>inner_join()</li>
</ul>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
